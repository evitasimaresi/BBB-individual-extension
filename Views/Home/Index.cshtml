@model List<BBB.Models.TagGroup>
@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var statuses = ViewBag.Statuses as List<BBB.Models.Status>;
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">

    <title>BBB</title>
    <link rel="icon" type="image/x-icon" href="~/Images/logo.png">
    <link rel="stylesheet" href="~/css/popUpStyles.css" />
</head>

<body>
    <main id="main-content">
        <form role="search" class="searchbar" id="game-search-form">
            <input type="text" id="game-search-input" name="query" autocomplete="off" placeholder="Search..." />
            <button id="search-clear" type="button" aria-label="Clear search">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"
                    focusable="false">
                    <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
            </button>
            <button type="submit">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                    <path
                        d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z" />
                </svg>
            </button>
        </form>

        <section id="indexmain">
            <section class="filters-container">
                <form class="filters-form">
                    <!-- Status Filter -->
                    <div class="filter-group">
                        <button type="button" class="filter-toggle" data-filter="status">
                            <span>Status</span>
                            <span class="filter-icon">+</span>
                        </button>
                        <div class="filter-content" id="status">
                            @if (statuses != null)
                            {
                                @foreach (var status in statuses)
                                {
                                    <label class="filter-option">
                                        <input type="checkbox" name="status" value="@status.Id" data-status="@status.Id">
                                        <span class="checkmark"></span>
                                        @status.Name
                                    </label>
                                }
                            }
                        </div>
                    </div>
                    @foreach (var group in Model)
                    {
                        <div class="filter-group">
                            <button type="button" class="filter-toggle"
                                data-filter="@group.Name.ToLower().Replace(" ", "")">
                                <span>@group.Name</span>
                                <span class="filter-icon">+</span>
                            </button>
                            <div class="filter-content" id="@group.Name.ToLower().Replace(" ", "")">
                                @foreach (var tag in group.Tags.OrderBy(t => t.Name))
                                {
                                    <label class="filter-option">
                                        <input type="checkbox" name="@group.Name.ToLower().Replace(" ", "")" value="@tag.Id"
                                            data-group="@group.Id">
                                        <span class="checkmark"></span>
                                        @tag.Name
                                    </label>
                                }
                            </div>
                        </div>
                    }
                </form>
            </section>

            <nav class="scroll-container">
                <ul class="scrolloverflow">

                </ul>
            </nav>
        </section>

    </main>


    <dialog id="editGame">

        <form class="game-edit-form" id="edit-game-form" enctype="multipart/form-data">
            <input type="hidden" id="gameId" name="Id" />

            <section>
                <label for="gameTitle" style="display:block; font-weight:bold; margin-bottom:5px;">Game Title</label>
                <input type="text" id="gameTitle" name="GameTitle" required>
            </section>

            <section>
                <label for="gameCover" style="display:block; font-weight:bold; margin-bottom:5px;">Game Cover</label>
                <input type="file" id="gameCover" name="GameCover" accept="image/*" required>
            </section>

            <section>
                <label for="gameDesc" style="display:block; font-weight:bold; margin-bottom:5px;">Description</label>
                <textarea id="gameDesc" name="GameDesc" rows="4" required></textarea>
            </section>

            <section>
                <label for="gameCond" style="display:block; font-weight:bold; margin-bottom:5px;">Condition</label>
                <input type="text" id="gameCond" name="GameCond" required>
            </section>

            <section>
                <label for="gameLink" style="display:block; font-weight:bold; margin-bottom:5px;">Link</label>
                <input type="text" id="gameLink" name="GameLink" required>
            </section>

            <button id="button-save" type="submit">Save</button>
            <button id="button-cancel" type="button">Cancel</button>
            <button id="button-delete" type="button">Delete</button>

        </form>
    </dialog>

    <script>const allowEdit = @(ViewBag.IsAdmin ? "true" : "false");</script>
    <script type="module" src="~/js/apiClient.js"></script>
    <script type="module" src="~/js/services.js"></script>
    <script type="module" src="~/js/renderBoardGames.js"></script>

</body>

</html>